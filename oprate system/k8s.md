# Kubernetes (K8s) 介绍

## 什么是 Kubernetes

Kubernetes（简称 K8s）是一个开源的容器编排平台，用于自动化容器化应用程序的部署、扩展和管理。它最初由 Google 设计并开源，现在由 Cloud Native Computing Foundation (CNCF) 维护。

## 主要特点

### 1. 容器编排
- **自动化部署**：自动将容器部署到集群中的合适节点
- **自动扩缩容**：根据负载自动增减容器实例
- **滚动更新**：无停机时间的应用更新
- **回滚机制**：快速回滚到之前的版本

### 2. 服务发现和负载均衡
- **DNS 服务发现**：自动为服务分配 DNS 名称
- **负载均衡**：在多个容器实例间分配流量
- **健康检查**：自动检测和替换不健康的容器

### 3. 存储编排
- **持久化存储**：支持各种存储后端（本地存储、云存储等）
- **动态存储供应**：根据需求自动分配存储
- **存储类**：定义不同类型的存储配置

### 4. 自我修复
- **故障检测**：监控容器和节点健康状态
- **自动重启**：重启失败的容器
- **节点故障处理**：将故障节点上的工作负载迁移到健康节点

### 5. 配置和密钥管理
- **ConfigMap**：管理应用配置
- **Secret**：安全存储敏感信息
- **环境变量注入**：动态配置应用参数

## 核心概念

### Pod
- 最小部署单位
- 包含一个或多个紧密相关的容器
- 共享网络和存储

### Service
- 为 Pod 提供稳定的网络访问入口
- 支持负载均衡
- 类型：ClusterIP、NodePort、LoadBalancer、ExternalName

### Deployment
- 管理 Pod 的副本集
- 支持滚动更新和回滚
- 声明式配置

### Namespace
- 逻辑隔离资源
- 多租户支持
- 资源配额管理

# 主要用途

### 1. 微服务架构
- **服务解耦**：将单体应用拆分为微服务
- **独立部署**：每个服务可独立部署和更新
- **技术栈多样性**：不同服务可使用不同技术栈

### 2. DevOps 和 CI/CD
- **持续集成**：自动化构建和测试
- **持续部署**：自动化部署到生产环境
- **蓝绿部署**：零停机时间部署策略

### 3. 云原生应用
- **弹性扩展**：根据负载自动扩缩容
- **多云部署**：在不同云平台间迁移
- **混合云**：本地和云端资源统一管理

### 4. 资源优化
- **资源利用率**：提高服务器资源利用效率
- **成本控制**：按需分配资源，降低成本
- **多环境管理**：统一管理开发、测试、生产环境

## 架构组件

### Master 节点组件
- **API Server**：集群的前端接口
- **etcd**：分布式键值存储，保存集群状态
- **Scheduler**：负责 Pod 调度
- **Controller Manager**：运行控制器进程

### Node 节点组件
- **kubelet**：节点代理，管理 Pod 生命周期
- **kube-proxy**：网络代理，实现服务发现和负载均衡
- **Container Runtime**：容器运行时（Docker、containerd 等）

## 使用场景

### 适合的场景
- 大型分布式系统
- 微服务架构应用
- 需要高可用性的应用
- 多环境部署需求
- 容器化应用管理

### 不太适合的场景
- 简单的单体应用
- 小型团队项目
- 对复杂性敏感的项目
- 学习成本受限的团队

// ...existing code...

## 常见操作

### 查看 Kubernetes 服务和端口
要查看本机（Node）上运行的 Kubernetes 服务，可以使用以下命令：

```sh
kubectl get svc
```

如果想查看某个命名空间下的服务：

```sh
kubectl get svc -n <namespace>
```

要查看本机（Node）上实际运行的 Pod 可以用：

```sh
kubectl get pods -o wide
```

如果需要查看本地端口映射，可以使用 `kubectl port-forward`：

```sh
kubectl port-forward svc/<service-name> <local-port>:<service-port>
```

这样可以将本地端口转发到指定的服务端口，方便本地访问。